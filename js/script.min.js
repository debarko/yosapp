function checkEmail(a){var b=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;if(!b.test(a)){return false}return true}function formhash(f,a,e,b){var d=hex_sha512(a);var c={username:f,password:d,cc:e};$.ajax({type:"POST",url:"login.php",data:c,dataType:"json"}).success(function(g){if(g.status===true){YW.NAME=g.name;log_in_user()}else{dispErrMsg(g.reason,"login");if(b){b.reset()}}}).fail(function(g){console.log("ERROR")})}function regformhash(c,f,g,i,d,a){if(f.value==""||g.value==""||i.value==""||d.value==""||a.value==""){dispErrMsg("You must provide all the requested details. Please try again","reg");return false}j=/^\w+$/;if(!j.test(c.username.value)){dispErrMsg("Usernames may contain only digits along with country code","reg");c.username.focus();return false}if(i.value.length<6){dispErrMsg("Passwords must be at least 6 characters long.  Please try again","reg");c.password.focus();return false}var j=/(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}/;if(!j.test(i.value)){dispErrMsg("Passwords must contain at least one number, one lowercase and one uppercase letter.  Please try again","reg");return false}if(!checkEmail(g.value)){dispErrMsg("Your email is not a valid address. Please try again","reg");c.email.focus();return false}var b=hex_sha512(i.value);var e={username:f.value,email:g.value,p:b,name:a.value,cc:extractCC(d.value)};$.ajax({type:"POST",url:"register.php",data:e,dataType:"text"}).success(function(k){if(k==="SUCCESS"){formhash(document.getElementById("regInputPhone").value,document.getElementById("regpass").value,extractCC(document.getElementById("regInputCountry").value));dispErrMsg("You have successfully registered. Logging you in...","reg");document.getElementById("regform").reset();$("#regform").animate({opacity:"0"},800);setTimeout(function(){$("#regform").css("visibility","hidden")},800)}else{dispErrMsg(k,"reg")}}).fail(function(k){dispErrMsg("Something went wrong, please refresh the page and try again.","reg");return false})}var hexcase=0;var b64pad="";function hex_sha512(a){return rstr2hex(rstr_sha512(str2rstr_utf8(a)))}function b64_sha512(a){return rstr2b64(rstr_sha512(str2rstr_utf8(a)))}function any_sha512(a,b){return rstr2any(rstr_sha512(str2rstr_utf8(a)),b)}function hex_hmac_sha512(a,b){return rstr2hex(rstr_hmac_sha512(str2rstr_utf8(a),str2rstr_utf8(b)))}function b64_hmac_sha512(a,b){return rstr2b64(rstr_hmac_sha512(str2rstr_utf8(a),str2rstr_utf8(b)))}function any_hmac_sha512(a,c,b){return rstr2any(rstr_hmac_sha512(str2rstr_utf8(a),str2rstr_utf8(c)),b)}function sha512_vm_test(){return hex_sha512("abc").toLowerCase()=="ddaf35a193617abacc417349ae20413112e6fa4e89a97ea20a9eeee64b55d39a2192992a274fc1a836ba3c23a3feebbd454d4423643ce80e2a9ac94fa54ca49f"}function rstr_sha512(a){return binb2rstr(binb_sha512(rstr2binb(a),a.length*8))}function rstr_hmac_sha512(c,f){var e=rstr2binb(c);if(e.length>32){e=binb_sha512(e,c.length*8)}var a=Array(32),d=Array(32);for(var b=0;b<32;b++){a[b]=e[b]^909522486;d[b]=e[b]^1549556828}var g=binb_sha512(a.concat(rstr2binb(f)),1024+f.length*8);return binb2rstr(binb_sha512(d.concat(g),1024+512))}function rstr2hex(c){try{hexcase}catch(g){hexcase=0}var f=hexcase?"0123456789ABCDEF":"0123456789abcdef";var b="";var a;for(var d=0;d<c.length;d++){a=c.charCodeAt(d);b+=f.charAt((a>>>4)&15)+f.charAt(a&15)}return b}function rstr2b64(c){try{b64pad}catch(k){b64pad=""}var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var b="";var a=c.length;for(var f=0;f<a;f+=3){var l=(c.charCodeAt(f)<<16)|(f+1<a?c.charCodeAt(f+1)<<8:0)|(f+2<a?c.charCodeAt(f+2):0);for(var d=0;d<4;d++){if(f*8+d*6>c.length*8){b+=b64pad}else{b+=g.charAt((l>>>6*(3-d))&63)}}}return b}function rstr2any(o,c){var b=c.length;var n,f,a,p,e;var l=Array(Math.ceil(o.length/2));for(n=0;n<l.length;n++){l[n]=(o.charCodeAt(n*2)<<8)|o.charCodeAt(n*2+1)}var k=Math.ceil(o.length*8/(Math.log(c.length)/Math.log(2)));var g=Array(k);for(f=0;f<k;f++){e=Array();p=0;for(n=0;n<l.length;n++){p=(p<<16)+l[n];a=Math.floor(p/b);p-=a*b;if(e.length>0||a>0){e[e.length]=a}}g[f]=p;l=e}var d="";for(n=g.length-1;n>=0;n--){d+=c.charAt(g[n])}return d}function str2rstr_utf8(c){var b="";var d=-1;var a,e;while(++d<c.length){a=c.charCodeAt(d);e=d+1<c.length?c.charCodeAt(d+1):0;if(55296<=a&&a<=56319&&56320<=e&&e<=57343){a=65536+((a&1023)<<10)+(e&1023);d++}if(a<=127){b+=String.fromCharCode(a)}else{if(a<=2047){b+=String.fromCharCode(192|((a>>>6)&31),128|(a&63))}else{if(a<=65535){b+=String.fromCharCode(224|((a>>>12)&15),128|((a>>>6)&63),128|(a&63))}else{if(a<=2097151){b+=String.fromCharCode(240|((a>>>18)&7),128|((a>>>12)&63),128|((a>>>6)&63),128|(a&63))}}}}}return b}function str2rstr_utf16le(b){var a="";for(var c=0;c<b.length;c++){a+=String.fromCharCode(b.charCodeAt(c)&255,(b.charCodeAt(c)>>>8)&255)}return a}function str2rstr_utf16be(b){var a="";for(var c=0;c<b.length;c++){a+=String.fromCharCode((b.charCodeAt(c)>>>8)&255,b.charCodeAt(c)&255)}return a}function rstr2binb(b){var a=Array(b.length>>2);for(var c=0;c<a.length;c++){a[c]=0}for(var c=0;c<b.length*8;c+=8){a[c>>5]|=(b.charCodeAt(c/8)&255)<<(24-c%32)}return a}function binb2rstr(b){var a="";for(var c=0;c<b.length*32;c+=8){a+=String.fromCharCode((b[c>>5]>>>(24-c%32))&255)}return a}var sha512_k;function binb_sha512(q,B){if(sha512_k==undefined){sha512_k=new Array(new int64(1116352408,-685199838),new int64(1899447441,602891725),new int64(-1245643825,-330482897),new int64(-373957723,-2121671748),new int64(961987163,-213338824),new int64(1508970993,-1241133031),new int64(-1841331548,-1357295717),new int64(-1424204075,-630357736),new int64(-670586216,-1560083902),new int64(310598401,1164996542),new int64(607225278,1323610764),new int64(1426881987,-704662302),new int64(1925078388,-226784913),new int64(-2132889090,991336113),new int64(-1680079193,633803317),new int64(-1046744716,-815192428),new int64(-459576895,-1628353838),new int64(-272742522,944711139),new int64(264347078,-1953704523),new int64(604807628,2007800933),new int64(770255983,1495990901),new int64(1249150122,1856431235),new int64(1555081692,-1119749164),new int64(1996064986,-2096016459),new int64(-1740746414,-295247957),new int64(-1473132947,766784016),new int64(-1341970488,-1728372417),new int64(-1084653625,-1091629340),new int64(-958395405,1034457026),new int64(-710438585,-1828018395),new int64(113926993,-536640913),new int64(338241895,168717936),new int64(666307205,1188179964),new int64(773529912,1546045734),new int64(1294757372,1522805485),new int64(1396182291,-1651133473),new int64(1695183700,-1951439906),new int64(1986661051,1014477480),new int64(-2117940946,1206759142),new int64(-1838011259,344077627),new int64(-1564481375,1290863460),new int64(-1474664885,-1136513023),new int64(-1035236496,-789014639),new int64(-949202525,106217008),new int64(-778901479,-688958952),new int64(-694614492,1432725776),new int64(-200395387,1467031594),new int64(275423344,851169720),new int64(430227734,-1194143544),new int64(506948616,1363258195),new int64(659060556,-544281703),new int64(883997877,-509917016),new int64(958139571,-976659869),new int64(1322822218,-482243893),new int64(1537002063,2003034995),new int64(1747873779,-692930397),new int64(1955562222,1575990012),new int64(2024104815,1125592928),new int64(-2067236844,-1578062990),new int64(-1933114872,442776044),new int64(-1866530822,593698344),new int64(-1538233109,-561857047),new int64(-1090935817,-1295615723),new int64(-965641998,-479046869),new int64(-903397682,-366583396),new int64(-779700025,566280711),new int64(-354779690,-840897762),new int64(-176337025,-294727304),new int64(116418474,1914138554),new int64(174292421,-1563912026),new int64(289380356,-1090974290),new int64(460393269,320620315),new int64(685471733,587496836),new int64(852142971,1086792851),new int64(1017036298,365543100),new int64(1126000580,-1676669620),new int64(1288033470,-885112138),new int64(1501505948,-60457430),new int64(1607167915,987167468),new int64(1816402316,1246189591))}var r=new Array(new int64(1779033703,-205731576),new int64(-1150833019,-2067093701),new int64(1013904242,-23791573),new int64(-1521486534,1595750129),new int64(1359893119,-1377402159),new int64(-1694144372,725511199),new int64(528734635,-79577749),new int64(1541459225,327033209));var t=new int64(0,0),s=new int64(0,0),K=new int64(0,0),J=new int64(0,0),I=new int64(0,0),G=new int64(0,0),F=new int64(0,0),E=new int64(0,0),D=new int64(0,0),C=new int64(0,0),n=new int64(0,0),l=new int64(0,0),u=new int64(0,0),p=new int64(0,0),A=new int64(0,0),y=new int64(0,0),v=new int64(0,0);var w,z;var o=new Array(80);for(z=0;z<80;z++){o[z]=new int64(0,0)}q[B>>5]|=128<<(24-(B&31));q[((B+128>>10)<<5)+31]=B;for(z=0;z<q.length;z+=32){int64copy(K,r[0]);int64copy(J,r[1]);int64copy(I,r[2]);int64copy(G,r[3]);int64copy(F,r[4]);int64copy(E,r[5]);int64copy(D,r[6]);int64copy(C,r[7]);for(w=0;w<16;w++){o[w].h=q[z+2*w];o[w].l=q[z+2*w+1]}for(w=16;w<80;w++){int64rrot(A,o[w-2],19);int64revrrot(y,o[w-2],29);int64shr(v,o[w-2],6);l.l=A.l^y.l^v.l;l.h=A.h^y.h^v.h;int64rrot(A,o[w-15],1);int64rrot(y,o[w-15],8);int64shr(v,o[w-15],7);n.l=A.l^y.l^v.l;n.h=A.h^y.h^v.h;int64add4(o[w],l,o[w-7],n,o[w-16])}for(w=0;w<80;w++){u.l=(F.l&E.l)^(~F.l&D.l);u.h=(F.h&E.h)^(~F.h&D.h);int64rrot(A,F,14);int64rrot(y,F,18);int64revrrot(v,F,9);l.l=A.l^y.l^v.l;l.h=A.h^y.h^v.h;int64rrot(A,K,28);int64revrrot(y,K,2);int64revrrot(v,K,7);n.l=A.l^y.l^v.l;n.h=A.h^y.h^v.h;p.l=(K.l&J.l)^(K.l&I.l)^(J.l&I.l);p.h=(K.h&J.h)^(K.h&I.h)^(J.h&I.h);int64add5(t,C,l,u,sha512_k[w],o[w]);int64add(s,n,p);int64copy(C,D);int64copy(D,E);int64copy(E,F);int64add(F,G,t);int64copy(G,I);int64copy(I,J);int64copy(J,K);int64add(K,t,s)}int64add(r[0],r[0],K);int64add(r[1],r[1],J);int64add(r[2],r[2],I);int64add(r[3],r[3],G);int64add(r[4],r[4],F);int64add(r[5],r[5],E);int64add(r[6],r[6],D);int64add(r[7],r[7],C)}var k=new Array(16);for(z=0;z<8;z++){k[2*z]=r[z].h;k[2*z+1]=r[z].l}return k}function int64(b,a){this.h=b;this.l=a}function int64copy(b,a){b.h=a.h;b.l=a.l}function int64rrot(c,a,b){c.l=(a.l>>>b)|(a.h<<(32-b));c.h=(a.h>>>b)|(a.l<<(32-b))}function int64revrrot(c,a,b){c.l=(a.h>>>b)|(a.l<<(32-b));c.h=(a.l>>>b)|(a.h<<(32-b))}function int64shr(c,a,b){c.l=(a.l>>>b)|(a.h<<(32-b));c.h=(a.h>>>b)}function int64add(g,b,f){var d=(b.l&65535)+(f.l&65535);var c=(b.l>>>16)+(f.l>>>16)+(d>>>16);var a=(b.h&65535)+(f.h&65535)+(c>>>16);var e=(b.h>>>16)+(f.h>>>16)+(a>>>16);g.l=(d&65535)|(c<<16);g.h=(a&65535)|(e<<16)}function int64add4(k,o,n,l,j){var i=(o.l&65535)+(n.l&65535)+(l.l&65535)+(j.l&65535);var g=(o.l>>>16)+(n.l>>>16)+(l.l>>>16)+(j.l>>>16)+(i>>>16);var f=(o.h&65535)+(n.h&65535)+(l.h&65535)+(j.h&65535)+(g>>>16);var e=(o.h>>>16)+(n.h>>>16)+(l.h>>>16)+(j.h>>>16)+(f>>>16);k.l=(i&65535)|(g<<16);k.h=(f&65535)|(e<<16)}function int64add5(n,q,p,o,l,k){var j=(q.l&65535)+(p.l&65535)+(o.l&65535)+(l.l&65535)+(k.l&65535);var i=(q.l>>>16)+(p.l>>>16)+(o.l>>>16)+(l.l>>>16)+(k.l>>>16)+(j>>>16);var g=(q.h&65535)+(p.h&65535)+(o.h&65535)+(l.h&65535)+(k.h&65535)+(i>>>16);var f=(q.h>>>16)+(p.h>>>16)+(o.h>>>16)+(l.h>>>16)+(k.h>>>16)+(g>>>16);n.l=(j&65535)|(i<<16);n.h=(g&65535)|(f<<16)}function sendActualMessage(a){if(YW.CURR_PARTNER===""||YW.CURR_PARTNER==="0server"){return false}$aJX_status=$.ajax({type:"GET",url:"./transactor.php?method=send&to="+YW.CURR_PARTNER+"&message="+a}).success(function(b){if(b==="sent"){return true}else{return false}}).fail(function(b){return false});return $aJX_status}function checkMessage(){$aJX_status=$.ajax({type:"GET",url:"./transactor.php?method=listen"}).success(function(a){a=(typeof a==="string")?a.trim():a;if(a==="empty"){return false}if(a==="nomessage"){return false}if(a==="noauth"){showNotif("You are not logged in.");setTimeout(function(){hideNotif();window.location="logout.php"},3000);return false}if(a==="noconnect"){showNotif("We can't connect to Whatsapp. Please send a feedback.");setTimeout(function(){hideNotif()},3000);checkForWPass();return false}if(a==="emptyauth"){showNotif("It seems that you haven't verified yet. Checking...");setTimeout(function(){hideNotif()},3000);checkForWPass();return false}processMessage(a);return true}).fail(function(a){return false});return $aJX_status}function getFriends(){$aJX_status=$.ajax({type:"GET",url:"./user.php?request=friends"}).success(function(a){times=0;if(a==="empty"){return false}else{YW.DATA=JSON.parse(a);renderData();setLastChat();showServerMessages();return true}}).fail(function(a){times=0;return false})}function imei_gen(){var l;var k=new Array(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var f=0;var b=0;var n=0;var c=0;var i=16;var g;var a=["01","10","30","33","35","44","45","49","50","51","52","53","54","86","91","98","99"];var e=a[Math.floor(Math.random()*a.length)].split("");k[0]=Number(e[0]);k[1]=Number(e[1]);l=2;var j=new Date();k[l++]=Math.floor(j.getDate()/10);k[l++]=(j.getDate()%10);k[l++]=Math.floor(j.getMonth()/10);k[l++]=j.getMonth()%10;k[l++]=Math.floor((j.getFullYear()/10/10-Math.floor((j.getFullYear()/10)/10))*10);k[l++]=j.getFullYear()%10;k[l++]=Math.floor(j.getHours()/10);k[l++]=j.getHours()%10;k[l++]=Math.floor(j.getMinutes()/10);k[l++]=j.getMinutes()%10;k[l++]=Math.floor(j.getSeconds()/10);k[l++]=j.getSeconds()%10;k[l++]=Math.floor(Math.random()*10)%10;c=(i+1)%2;for(l=0;l<i-1;l++){if((l+c)%2){n=k[l]*2;if(n>9){n-=9}f+=n}else{f+=k[l]}}b=(10-(f%10))%10;k[i-1]=b;n=k.join("");n=n.substr(0,i);return n}function maximize(a,b){$("#whatsapponwebText").css("display","none");$("#bannerText").fadeOut(500);$("#header").animate({height:"6%"},500);$("#footer").animate({height:"6%"},500);$("#bodybg").animate({height:"88%"},500);$("#bodybg").fadeOut(500,function(){$("#bodybg").fadeIn(500);$("#bodybg").html(a);$("#bodybg").css("background-color","white");if(b){b()}})}function log_in_user(){sendPage("/login");YW.logged_in=function(){return"true"};YW.LISTENER=setInterval(function(){checkMessage()},10000);getkeyVal();maximize(YW.CHATSCREEN()+YW.MODAL(),function(){checkForWPass();getFriends();sendPage("/home");$("#typemsg").focus();$("#icons").html(YW.LOGGED_IN_H());$("#icons").css("top","10%");$("#icons").css("right","0%");setSearchContainerHeight();randomPicGen($("#profilepic"),YW.NAME);$("#profilename").html(YW.NAME);$("#feedback").css("display","block");$("#puller-btn").click(function(){$("#leftpannel").css("width","100%");$("#rightpannel").css("width","0%");$("#puller-btn").css("visibility","hidden");$("#sendbutton").css("visibility","hidden")});$("#pusher-btn").click(function(){$("#leftpannel").css("width","0%");$("#rightpannel").css("width","100%");$("#puller-btn").css("visibility","visible");$("#sendbutton").css("visibility","visible")});$("#typemsg").keypress(function(a){if(a.keyCode==10||a.keyCode==13){sendMyMsg($("#typemsg").val())}})})}function showServerMessages(){jsnData=[["0server",formatAMPM(new Date()),"Hey you!!"],["0server",formatAMPM(new Date()),"Welcome to Yosapp.com. My name is Yosapp Server. You can ask me anything you want.. Hope you already know that this is an online version of Whatsapp."],["0server",formatAMPM(new Date()),"Below you can type messages and send them to your friends. Pretty Simple right? Lets start by doing something new., such as Adding a Friend."]];processMessage(jsnData)}function showInputTipsOnload(){var a=$(".showTipInputFields").map(function(c){var b=$("#"+this.id);var d=b.attr("tip");b.val(d);return d})}function getRandomInt(b,a){return Math.floor(Math.random()*(a-b+1))+b}function countryToCC(c){var a;try{YW.COUNTRIES.forEach(function(f,e,d){if(f[0]==c){a=f[1];throw a}})}catch(b){if(b!==a){throw b}return a}}function countrySuggest(a){a=a.toLowerCase();var d=[];for(someCounter=0;someCounter<YW.COUNTRIES.length;someCounter++){var c=YW.COUNTRIES[someCounter][0];var b=c.substring(0,a.length);if(b.toLowerCase()==a){d.push(YW.COUNTRIES[someCounter])}}return d}function CCtoCountry(c){var a;try{YW.COUNTRIES.forEach(function(f,e,d){if(f[1]==c){a=f[0];throw a}})}catch(b){if(b!==a){throw b}return a}}function findContactByName(a){a=a.toLowerCase();var d=[];for(var b in YW.DATA){if(b==="0server"){continue}var c=YW.DATA[b].name.substring(0,a.length);if(c.toLowerCase()==a){d.push(YW.DATA[b])}}return d}function focusItem(a){$(a).focus()}function updateContactname(c,b,a){$("[id="+a+"]").each(function(d,e){if($(e).prev().html()==b){$(e).prev().prev().html(c)}})}function getkeyVal(){$.ajax({type:"POST",url:"user.php?request=getkeyVal",dataType:"text"}).success(function(a){if(a!=="sqlfail"){a=decodeURIComponent(a);YW.KEYVAL=JSON.parse(a)}})}function setkeyVal(){$.ajax({type:"POST",url:"user.php?request=setkeyVal",data:{value:encodeURIComponent(JSON.stringify(YW.KEYVAL))},dataType:"text"})}function setValue(a,b){YW.KEYVAL[a]=b;setkeyVal()}function getValue(a){if(YW.KEYVAL[a]===undefined){setValue(a,YW.KEYDEF[a])}return YW.KEYVAL[a]}function extractCC(b){var a=b.match(/\+([0-9]+)\)/);return a[1]}function setSelectionRange(b,c,d){if(b.setSelectionRange){b.focus();b.setSelectionRange(c,d)}else{if(b.createTextRange){var a=b.createTextRange();a.collapse(true);a.moveEnd("character",d);a.moveStart("character",c);a.select()}}}function setCaretToPos(a,b){setSelectionRange(a.get(0),b,b)}function getCaretPos(a){return a.get(0).selectionStart}function showPopNotification(b,a){showNotif(b);setTimeout(function(){hideNotif();if(a){a()}},3000)}function isInt(a){return typeof a==="number"&&a%1==0}function closeOnEsc(a){if(a.keyCode=="27"){closeModal()}}function dissectPhoneNumber(b){var a;try{YW.COUNTRIES.forEach(function(d){if(b.indexOf(d[1])===0){a=d[1];throw a}})}catch(c){if(c!==a){throw c}return[a,b.slice(a.length)]}}function sendPage(a){ga("send","pageview",a)}"use strict";var isloginclicked=false,issignupclicked=false;window.onerror=function(c,b,a){$aJX_status=$.ajax({type:"GET",url:"error.php?ua="+encodeURIComponent(YW.UA())+"&msg="+encodeURIComponent(c)+"&linenumber="+encodeURIComponent(a)})};function toggleLogin(){if(isloginclicked){$(".logintooltips").css("visibility","visible");$("#loginform").animate({opacity:"0"},800,function(){$("#loginform").css("visibility","hidden").find("#countryField").val("");hideTip("#countryField")});isloginclicked=false}else{if(YW.PORTRAIT){$(".logintooltips").css("visibility","hidden")}$("#loginform").css("visibility","visible");$("#loginform").animate({opacity:"1"},800);if(!YW.PORTRAIT){$("#userfield").focus()}isloginclicked=true;$("#regform").animate({opacity:"0"},800,function(){$("#regform").css("visibility","hidden").find("#regInputCountry").val("");hideTip("#regInputCountry")});issignupclicked=false}}function toggleSignup(){if(issignupclicked){$(".logintooltips").css("visibility","visible");$("#regform").animate({opacity:"0"},800,function(){$("#regform").css("visibility","hidden").find("#regInputCountry").val("");hideTip("#regInputCountry")});issignupclicked=false}else{if(YW.PORTRAIT){$(".logintooltips").css("visibility","hidden")}$("#regform").css("visibility","visible");$("#regform").animate({opacity:"1"},800);if(!YW.PORTRAIT){$("#regInputPhone").focus()}issignupclicked=true;$("#loginform").animate({opacity:"0"},800,function(){$("#loginform").css("visibility","hidden").find("#countryField").val("");hideTip("#countryField")});isloginclicked=false}}window.onload=function(){if(YW.logged_in()==="true"){logged_in_start()}else{logged_out_start()}$("#loginbutton").hover(function(){$(".logintooltips").find("span").animate({opacity:"1"},600)},function(){$(".logintooltips").find("span").animate({opacity:"0"},600)});$("#signup").hover(function(){$(".signuptooltip").find("span").css("z-index","999").animate({opacity:"1"},600)},function(){$(".signuptooltip").find("span").css("z-index","0").animate({opacity:"0"},600)});$("#loginbutton").click(toggleLogin);$("#signup").click(toggleSignup);$("#regform").keyup(function(a){closeFormOnEsc(a,"#regform")});$("#loginform").keyup(function(a){closeFormOnEsc(a,"#loginform")});$("#regsubmitbutton").click(function(){$("#regsubmitbutton").css("-webkit-transform","1")});$("#footer").html($("#footer").html()+YW.MODAL());$("#footer").html($("#footer").html()+YW.PROMPT())};function closeFormOnEsc(b,a){if(b.keyCode=="27"){if($("#errorMsgBox").css("visibility")=="visible"){closeErrorMgsBox()}else{$(a).animate({opacity:"0"},500);setTimeout(function(){$(a).css("visibility","hidden")},800);isloginclicked=false}}}function logged_in_start(){log_in_user()}function logged_out_start(){$("#bodybg").html(YW.HOMESCREEN());$("#icons").html(YW.LOGGED_OUT_H());showLoginTipOnLoad();if(YW.PORTRAIT){portraitLoad()}}function portraitLoad(){toggleLogin()}function showLoginTipOnLoad(){if(YW.PORTRAIT){return}$(".logintooltips").find("span").animate({opacity:"1"},1600,"linear",function(){$(".logintooltips").find("span").animate({opacity:"0"},1600,"linear")})}function hideTip(d){var b=$(d);var a=b.val();var c=b.next();if(a!=""){if(c.css("display")!="none"){c.css("display","none");return}return}else{c.css("display","inline-block")}}function dispErrMsg(c,b){var a=$("#errorMsgBox");if(b=="login"){$("#errorMsgBoxArrow").css({"border-right":"20px solid rgba(255, 255, 255, 0.19)","border-left":"0px",left:"-20px"});$("#closeErrMsgBox").css("left","235px")}else{if(b=="reg"){$("#errorMsgBoxArrow").css({"border-right":"","border-left":"",left:""});$("#closeErrMsgBox").css("left","")}}if(a.css("visibility")=="hidden"){a.css("opacity","0");a.css("visibility","visible");a.animate({opacity:"1"},600,"swing")}$("#errMsg").html(c)}function closeErrorMgsBox(){$("#errorMsgBox").animate({opacity:"0"},700,"swing",function(){$("#errorMsgBox").css("visibility","hidden")})}function DlBoxLoading(e,b){var d="";var f="";var c="";var a="";if(b==1){d="#verStp1Left";f="#verStp1Right";c="#nextArrow1";a="#verLoadingIcon1"}else{if(b==2){d="#verStp2Left";f="#verStp2Right";c="#nextArrow2";a="#verLoadingIcon2"}}$(d+","+f+","+c).animate({opacity:"0"},300,function(){$(this).css("display","none");$(a).css({opacity:"0",display:"block"});$(a).find("p").html(e);$(a).animate({opacity:".6"},300)})}function DlBoxFinalMsg(e,a){var d="";var b="";var c="";if(a==1){d="#verLoadingIcon1";b="#verFaildMsg1Ref";c="#verFaildMsg1Text"}else{if(a==2){d="#verLoadingIcon2";b="#verFaildMsg2Ref";c="#verFaildMsg2Text"}}$(d).animate({opacity:"0"},300,function(){$(this).css("display","none");$(c).html(e);$(b+","+c).css({opacity:"0",display:"block"});$(b+","+c).animate({opacity:"1"},300)})}function showVersionWindow(a){$("#varifyWindow").css({opacity:"0",display:"block"});$("#varifyWindow").animate({opacity:"1"},100,function(){$("#varifyWindow").html(YW.RELEASECON());if(a){a()}})}function showPointerOnHover(a){$(a).css("cursor","pointer")}function showNotif(c){var b=$("#notify");var a=b.find("p");b.css({display:"block",height:"0px"});a.html(c).css("opacity","0");b.animate({height:"50px"},500,function(){a.animate({opacity:"1"},400)})}function hideNotif(){var b=$("#notify");var a=b.find("p");a.animate({opacity:"0"},400,function(){b.animate({height:"0px"},500,function(){b.css("display","none")})})}function showPrompt(c,e,d){showOverlay();var a=$("#prompt");var b=$("#prompMsg").find("p");$("#promptYes").click(function(f){f.preventDefault();if(typeof e==="function"){e()}});$("#promptNo").click(function(f){f.preventDefault();if(typeof d==="function"){d()}});b.html(c);a.css({opacity:"0",display:"block"});a.animate({opacity:"1"},400,function(){})}function closePrompt(){var a=$("#prompt");a.animate({opacity:"0"},400,function(){a.css("display","none");closeOverlay()})}function suggestCountries(b,g){var a=g.keyCode?g.keyCode:g.charCode;if((a>37&&a<41)||a==13||a==10||(a>32&&a<37)){if(a==33){for(var f=0;f<4;f++){navigateSuggested(38)}return}if(a==34){for(var f=0;f<4;f++){navigateSuggested(40)}return}navigateSuggested(a);return}var j=$(b);var d=j.parent().children().eq(j.parent().children().length-1);var k=j.val();if(k==j.attr("preval")){return}var l=countrySuggest(k);d.html("");if(k==""){d.css("display","none");$("#addConCCTip").prev().val("");$("#addConCCTip").html("CC");j.attr("preval",k).attr("ready","no");j.siblings().eq(2).removeClass("countryReady").removeClass("countryNotReady");return}else{d.css("display","block")}if(l.length==0){result1=k.match(/([a-zA-Z\s-_]+) /);if(result1!=null){countryname=countrySuggest(result1[1].trim())[0][0];d.append('<div class="suggestedElem" id="selectedCountry" onclick=\'selectCountry("'+countryname+'","'+countryToCC(countryname)+"\", this);' onmouseover='hoverSuggest(this);'><p>"+countryname+" (+"+countryToCC(countryname)+")</p></div>");j.attr("preval",k).attr("ready","no");j.siblings().eq(2).removeClass("countryReady").addClass("countryNotReady");return}d.append('<div class="suggestedElem"><p>No such country</p></div>');$("#addConCCTip").prev().val("");$("#addConCCTip").html("CC");return}for(var c=0;c<l.length;c++){d.append('<div class="suggestedElem" id="" pos="'+c+'"onclick=\'selectCountry("'+l[c][0]+'","'+countryToCC(l[c][0])+"\", this);' onmouseover='hoverSuggest(this);'><p>"+l[c][0]+" (+"+countryToCC(l[c][0])+")</p></div>")}$(".suggestedElem").first().attr("id","selectedCountry");j.attr("preval",k);d.focus()}function selectCountry(e,f,b){var d=$(b).parent();var a=d.parent().children().eq(0);d.css("display","none");if(a.attr("name")=="AddConCountryName"){a.val(e);var c=a.parent().next().children().eq(0);c.val("+"+f);$("#addConCCTip").html("");a.attr("ready","yes");return}a.val(e+" (+"+f+")");a.attr("ready","yes");a.siblings().eq(2).removeClass("countryNotReady").addClass("countryReady")}function hoverSuggest(a){$("#selectedCountry").attr("id","");$(a).attr("id","selectedCountry")}function navigateSuggested(a){var e=$(".countrySuggBox").children().length;if(a==38&&$("#selectedCountry").attr("pos")!="0"){$("#selectedCountry").attr("id","").prev().attr("id","selectedCountry");if(parseInt($("#selectedCountry").attr("pos"))<(e-5)){var b=(parseInt($("#selectedCountry").attr("pos")-2));$(".countrySuggBox").scrollTop(b*20)}return}if(a==40&&parseInt($("#selectedCountry").attr("pos"))!=e-1){$("#selectedCountry").attr("id","").next().attr("id","selectedCountry");if(parseInt($("#selectedCountry").attr("pos"))>4){var b=parseInt($("#selectedCountry").attr("pos"))-4;$(".countrySuggBox").scrollTop(b*20)}return}if(a==35){$("#selectedCountry").attr("id","");$("[pos="+(e-1)+"]").attr("id","selectedCountry");$(".countrySuggBox").scrollTop(e*20);return}if(a==36){$("#selectedCountry").attr("id","");$("[pos=0]").attr("id","selectedCountry");$(".countrySuggBox").scrollTop(0);return}if(a==13||a==10){var d=$("#selectedCountry").parent().parent().children().eq(0);if(d.attr("ready")=="yes"&&d.attr("id")!="countryName"){if(d.attr("id")=="countryField"){formhash(document.getElementById("userfield").value,document.getElementById("passfield").value,extractCC(document.getElementById("countryField").value),document.getElementById("loginform"));return}if(d.attr("id")=="regInputCountry"){regformhash(document.getElementById("regform"),document.getElementById("regInputPhone"),document.getElementById("email"),document.getElementById("regpass"),document.getElementById("regInputCountry"),document.getElementById("name_reg"))}return}if(d.attr("id")=="countryName"&&$("#countryCode").val()!=""){addContact()}if($("#selectedCountry").length==1){var c=$("#selectedCountry").html();var f=c.match(/([a-zA-Z\s-_]+) \(+/)[1];var g=c.match(/\+([0-9]+)\)/)[1];selectCountry(f,g,"#selectedCountry");$("#selectedCountry");return}}}function loadChatscreen(){setSearchContainerHeight();$("#concactsearch").find("input").click(function(){$("#concactsearch").find("input").css("background-color","black")})}$(window).resize(function(){setSearchContainerHeight()});function setSearchContainerHeight(){var a=$(window).height()*(80/100)-128;$("#contactscontainer").css("height",a+"px")}function setTextboxGap(){var a=$(".recmsg").css("height");a.each(function(b){alert(This.value)})}function loadMessageDiv(b){var a=$("#msgcontainer").html();$("#msgcontainer").html(a+b)}function formatAMPM(c){var a=c.getHours();var d=c.getMinutes();var b=a>=12?"pm":"am";a=a%12;a=a?a:12;d=d<10?"0"+d:d;var e=a+":"+d+" "+b;return e}function sendOtherMsg(a){if(a===""){return false}var b=new Date();h=b.getHours();m=b.getMinutes();formDivElem(1,a,formatAMPM(new Date()))}function sendMyMsg(b,a){if(b===""){return false}if(YW.CURR_PARTNER==="0server"){a=1}if(typeof a==="undefined"){status=sendActualMessage(b);if(!status){return false}storeMessage(YW.CURR_PARTNER,0,b)}var c=new Date();h=c.getHours();m=c.getMinutes();formDivElem(0,b,formatAMPM(new Date()));$("#typemsg").val("");if(YW.CURR_PARTNER==="0server"){sendOtherMsg(YW.ELIZA.transform(b))}autoScrollDown()}function formDivElem(c,d,e){loadMessageDiv(YW.CHATBUBBLE());var a=$("#msgcontainer > div");a=a[a.length-1];var b=generateRandomDivId();$(a).attr("id",b);if(c===0){tagMyBubble(b)}else{tagOtherBubble(b)}if(isImageMsg(d)){setImg(b,d)}else{if(isVideoMsg(d)){setVid(b,d)}else{setMessage(b,d)}}setTimeStamp(b,e);setOptionsWidth(b,c)}function isVideoMsg(a){if(a.indexOf("[ video:")===0){return true}else{return false}}function isImageMsg(a){if(a.indexOf("[ image:")===0){return true}else{return false}}function generateRandomDivId(){var a=new Date().toISOString();a=a.replace(/-/g,"");a=a.replace(/:/g,"");return CryptoJS.MD5(a).toString()}function tagMyBubble(a){$("#"+a+" > #mother_div > #sent_recv").addClass("sentmsg")}function tagOtherBubble(a){$("#"+a+" > #mother_div > #sent_recv").addClass("recmsg")}function setTimeStamp(b,a){$("#"+b+" > #mother_div > #sent_recv > #timestamp").html(a)}function setImg(d,b){var c=b.slice(b.indexOf("preview:")+8);c=c.slice(0,c.length-1);var a=b.slice(b.indexOf("[ image: ")+9,b.indexOf(", preview:"));b='<img class="imgThumb" src="data:image/jpg;base64,'+c+'" onclick=\'loadMediaURL("'+encodeURIComponent(a)+'", "image")\' />';$("#"+d+" > #mother_div > #sent_recv > .textbox").html(b+$("#"+d+" > #mother_div > #sent_recv > .textbox").html())}function setVid(d,b){var c=b.slice(b.indexOf("preview:")+8);c=c.slice(0,c.length-1);var a=b.slice(b.indexOf("[ video: ")+9,b.indexOf(", preview:"));b='<img class="imgThumb" src="data:image/jpg;base64,'+c+'" onclick=\'loadMediaURL("'+encodeURIComponent(a)+'", "video")\' />';$("#"+d+" > #mother_div > #sent_recv > .textbox").html(b+$("#"+d+" > #mother_div > #sent_recv > .textbox").html())}function setMessage(b,a){$("#"+b+" > #mother_div > #sent_recv > .textbox").html(a+$("#"+b+" > #mother_div > #sent_recv > .textbox").html())}function setOptionsWidth(c,b){var a=$("#"+c+" > #mother_div > #sent_recv").css("width");$("#"+c+" > #mother_div > .shareOptionsBar").css("width",a);$("#"+c+" > #mother_div > .shareOptionsBar > .midbar").css("width",(parseInt(a)-20)+"px");if(b){$("#"+c+" > #mother_div").css("float","left");$("#"+c+" > #mother_div > .shareOptionsBar").addClass("shareOptionsBar_left")}else{$("#"+c+" > #mother_div").css("float","right");$("#"+c+" > #mother_div").addClass("mother_div_right")}}function shareOption(){$(".shareOptionsBar").animate({top:"-1px"},800,"swing")}function showOverlay(b){var a=$("#overlay");a.css({opacity:"0",visibility:"visible"});a.animate({opacity:"1"},200,"swing",function(){if(b){b()}})}function showModal(c,a){var b=$("#modal");b.css("display","block");if(YW.logged_in()=="true"){$("#modalMenuBar").html(YW.L_IN());$("#modalRightPanel").html(YW.R_IN())}else{$("#modalMenuBar").html(YW.L_OUT());$("#modalRightPanel").html(YW.R_OUT())}showOverlay(function(){b.css({width:"0px",height:"0px",top:"50%",left:"50%",margin:"0px",border:"0px",visibility:"visible"});b.animate({width:"600px",height:"400px",top:"50%",left:"50%",margin:"-200px 0px 0px -300px"},300,"swing",function(){$("#modalCloseButton").css("visibility","visible");$("#modalContent").css("visibility","visible");selectModalItem(c,a);$("#contactFirstName").focus()})})}function selectModalItem(e,c){$(".modalRightMasterDiv").css("display","none");$(".modalMenuItem").removeClass("selectedModalMenuItem");if(e=="addCon"){$("#addContactForm").css("display","block");$("#modaladdContact").addClass("selectedModalMenuItem");return}else{if(e=="editProf"){$("#editProfForm").css("display","block");$("#modalEditProfile").addClass("selectedModalMenuItem");$("#profPreviewName").html($("#profilename").html());randomPicGen($("#profPreviewPic"),$("#profilename").html());return}else{if(e=="feedback"){$("#feedbackform").css("display","block");$("#modalFeedback").addClass("selectedModalMenuItem");return}else{if(e=="settings"){$("#settingsForm").css("display","block");$("#modalSettings").addClass("selectedModalMenuItem");return}else{if(e=="editCon"){$("#editContactForm").css("display","block");$("#modaleditContact").addClass("selectedModalMenuItem");var a=$(c).parent();var b=a.find("#name").html();var d=a.find("span").eq(3).attr("id");var f=a.find("#cc").html();fillEditContact(b,f,d);$("#contactFirstNameEdit").focus();hideTip($("#contactFirstNameEdit"));$("#phNumberEdit, #countryCodeEdit, #countryNameEdit").prop("disabled",true);return}else{if(e=="alpha"){$("#modalMenuAlpha").addClass("selectedModalMenuItem");$("#releaseHeader").html("Alpha Release");$("#releaseVersionText").html("Current Version:<br />Highly possible that it will be buggy.<br />We are working to fix a lot. But it is too soon to say it is complete. No group support.<br /><br />1. Basic Messaging with Phone Numbers<br />2. Image Receival<br />3. Video Receival<br />4. Adding of new Friends<br />5. Deleting Friends<br />6. Editing Friends<br />7. Connecting with Whatsapp Servers")}else{if(e=="beta"){$("#modalMenuBeta").addClass("selectedModalMenuItem");$("#releaseHeader").html("Beta Release");$("#releaseVersionText").html("Introducing the Beta version of Yosapp. This version supports mobile web browsers and will be easily displayed in Firefox OS.")}else{if(e=="RC1"){$("#modalMenuRC1").addClass("selectedModalMenuItem");$("#releaseHeader").html("Stable Release");$("#releaseVersionText").html("We are planning on a week per so saying anything about this is too far fetched.")}else{if(e=="dev"){$("#modalMenuDevlopers").addClass("selectedModalMenuItem");$("#releaseHeader").html("Open Source");$("#releaseVersionText").html("This is an Open Source Project and is based on Tarek Galal's Yowsup Project.<br />If you want the code for the project, then contact us at support@yosapp.com")}else{if(e=="vision"){$("#modalMenuVesion").addClass("selectedModalMenuItem");$("#releaseHeader").html("Our vision");$("#releaseVersionText").html("We believe: Human knowledge belongs to the world.<br/><br />Messages which are typed in the user data are not stored on Yosapp servers and they are directly forwarded to Whatsapp servers. We are just storing the username, password for your Yosapp account and the list of friends with whom you are connected at this moment. This app is an UNOFFICIAL client born out of necessity and require. It also allows landline users to connect to Whatsapp network through the portal.")}}}}}}}}}}}function closeModal(){sendPage("/home");var a=$("#modal");$("#modalContent").css("visibility","hidden");a.animate({width:"0px",height:"0px",top:"50%",left:"50%",margin:"0px",border:"0px"},300,"swing",function(){$("#modalCloseButton").css("visibility","hidden");$("#modal").css("display","none");closeOverlay()})}function closeOverlay(){var a=$("#overlay");a.animate({opacity:"0"},200,"swing",function(){a.css("visibility","hidden")})}function renderData(){$.each(YW.DATA,function(b,a){addContactElem(a.name,a.phone,a.cc)})}function addContactElem(b,a,g,e){$("#contactslist").append(YW.CONTACT())[$("#contactslist").length-1];var f;var d=new Date();d=d.getTime();var c=b.substr(0,1);c=c.toUpperCase();randomPicGen($("#contactslist li:last #contactImage"),b);$("#contactslist li:last #name").html(b);$("#contactslist li:last #cc").html(g);$("#contactslist li:last #number").attr("id",a);if(a=="server"){$("#contactslist li:last #editContactButton").remove()}return f}function selectMenuItem(a){$(".modalMenuItem").css("background-color","");$(a).css("background-color","#2AB200")}function setLastChat(){$("#contactslist").children().each(function(b,c){var a=$(c).find("span").eq(2).html()+""+$(c).find("span").eq(3).attr("id");if(a==="0server"){setCurrentPartner(c)}})}function processMessage(a){a.forEach(function(d){if(!YW.DATA[d[0]]){var c=dissectPhoneNumber(d[0]);addContactElem(d[0],c[1],c[0]);YW.DATA[d[0]]={phone:c[1],cc:c[0],name:d[0],messages:{},messageTree:[]};$aJX_status=$.ajax({type:"POST",url:"user.php?request=addfriend",data:{contact:c[1],cc:c[0],name:d[0]},dataType:"text"}).success(function(e){times=0;if(e==="SUCCESS"){return true}else{return false}}).fail(function(e){times=0;return false})}if(YW.DATA[d[0]].messages.unreadCount){YW.DATA[d[0]].messages.unreadCount++}else{YW.DATA[d[0]].messages.unreadCount=1}if(!YW.DATA[d[0]].messages.list){YW.DATA[d[0]].messages.list=[]}YW.DATA[d[0]].messages.list.push([d[2],1]);if(d[0]!=="0server"&&!document.hasFocus()){var b=decodeURIComponent(d[2]);if(isImageMsg(b)){b="Sent you an Image."}else{if(isVideoMsg(b)){b="Sent you a Video."}}notify(YW.DATA[d[0]].name+" ("+d[0]+")",b)}});renderCurrent();processUnread();calcUnread()}function calcUnread(){YW.UNREAD=0;for(var a in YW.DATA){if(YW.DATA[a].messages.unreadCount){YW.UNREAD+=YW.DATA[a].messages.unreadCount}}if(YW.UNREAD===0){document.title="Yosapp"}else{document.title="("+YW.UNREAD+") Yosapp"}return YW.UNREAD}function processUnread(){$("#contactslist").children().each(function(b,c){var a=$(c).find("span").eq(2).html()+""+$(c).find("span").eq(3).attr("id");if(YW.DATA[a].messages.unreadCount&&YW.DATA[a].messages.unreadCount!==0){showUnreadMsg(c,YW.DATA[a].messages.unreadCount)}})}function setCurrentPartner(a){if(a.children.item(2).innerHTML+a.children.item(3).id===YW.CURR_PARTNER){return}YW.CURR_PARTNER=a.children.item(2).innerHTML+a.children.item(3).id;$("#msgcontainer").html("<br /><br />");$(".contact").each(function(b,c){if($(c).css("background-color")){$(c).css("background-color","")}$(c).find("#editContactButton").css("display","")});$(a).css("background-color","rgba(42, 178, 0, 0.52)");$(a).find("#unreadMsgCnt").css("display","none");$(a).find("#editContactButton").css("display","inline-block");renderMessages();renderCurrent();calcUnread()}function replaceAll(c,a,b){return b.replace(new RegExp(c,"g"),a)}function renderCurrent(){if(!YW.DATA[YW.CURR_PARTNER]){return false}if(!YW.DATA[YW.CURR_PARTNER].messages.list){return false}YW.DATA[YW.CURR_PARTNER].messages.list.forEach(function(a){a[0]=decodeURIComponent(a[0]);a[0]=replaceAll("\n","<br />",a[0]);if(a[1]){sendOtherMsg(a[0]);storeMessage(YW.CURR_PARTNER,1,a[0]);autoScrollDown()}else{sendMyMsg(a[0])}});YW.DATA[YW.CURR_PARTNER].messages.list=[];YW.DATA[YW.CURR_PARTNER].messages.unreadCount=0}function autoScrollDown(){$("#msgcontainer").animate({scrollTop:$("#msgcontainer").get(0).scrollHeight},50)}function notify(c,b){var a=new Notify(c,{body:b,icon:"./icons/logo_min.png"});YW.NOTIFSOUND.play();a.show()}function reqNotifPerms(){var a=new Notify("Test");if(a.needsPermission()){a.requestPermission()}}function isPermsReqd(){var a=new Notify("Test");return a.needsPermission()}function askNotifPerm(){if(getValue("askNotifPerm")===1){if(!isPermsReqd()){return true}sendPage("/showNotifPerm");showPrompt("Would you like to allow Desktop Notification for incoming messages??",function(){sendPage("/showNotifPerm/accept");reqNotifPerms();setValue("askNotifPerm",1);closePrompt()},function(){sendPage("/showNotifPerm/reject");setValue("askNotifPerm",0);closePrompt()});sendPage("/home");return true}return false}function storeMessage(a,b,c){var d={};d.message=c;d.parent=b;YW.DATA[a].messageTree.push(d)}function renderMessages(){if(!YW.DATA[YW.CURR_PARTNER].messageTree){return false}var a=YW.DATA[YW.CURR_PARTNER].messageTree;a.forEach(function(b){if(b.parent===0){sendMyMsg(b.message,1)}else{sendOtherMsg(b.message)}})}function checkForWPass(){$aJX_status=$.ajax({type:"GET",url:"user.php?request=wpass_check"}).success(function(a){a=a.trim();if(a==="false"){sendPage("/showVerif");clearInterval(YW.LISTENER);$("#bodybg").html($("#bodybg").html()+YW.VERIF());showOverlay();showVerWindow();return true}else{askNotifPerm();return false}}).fail(function(a){return false})}function requestCode(){sendPage("/requestCode");DlBoxLoading("Please Wait. Sending your code.",1);YW.IMEI=imei_gen();$aJX_status=$.ajax({type:"GET",url:"transactor.php?method=codereq&via="+YW.VIA+"&id_user="+YW.IMEI}).success(function(c){if(c==="noauth"){DlBoxFinalMsg("You are not logged in. Please refresh and retry.",1);return false}else{if(c==="badparam"){DlBoxFinalMsg("We regret. Internal server error happened. Please refresh and try again. If it doesn't solve please contact us via Feedback.",1);return false}else{var b=/status: ([a-z]*)/i;var a=c.match(b);if(a&&a[1]!=="fail"){enterVerCode()}else{var e=/status: ([a-z]*)\nretry_after: ([0-9]*)/i;var d=c.match(e);if(d&&d[2]){DlBoxFinalMsg("Trying too soon. Please try after "+Math.floor(d[2]/60)+" minutes.",1)}}}}}).fail(function(a){return false})}function sendCode(){sendPage("/sendCode");code=$("#verCodeField").val();if(code===""||code===undefined){return false}DlBoxLoading("Please Wait. Confirming your code.",2);$aJX_status=$.ajax({type:"GET",url:"transactor.php?method=sendcode&code="+code+"&id_user="+YW.IMEI}).success(function(a){if(a==="noauth"){DlBoxFinalMsg("You are not logged in. Please refresh and retry.",2);return false}else{if(a==="badparam"){DlBoxFinalMsg("We regret. Some Internal server error happened. Please refresh and try again. If it doesn't solve please contact us via Feedback.",2);return false}else{if(a==="success"){successDialougeBox()}else{DlBoxFinalMsg("Wrong Code. Please try again.",2);return false}}}}).fail(function(a){return false})}function clearVerif(){sendPage("/closeVerif");sendPage("/home");$("#varifyWindow").css("display","none");closeOverlay();YW.LISTENER=setInterval(function(){checkMessage()},10000)}function sendFeedback(){sendPage("/sendFeedback");$aJX_status=$.ajax({type:"GET",url:"feedback.php?ua="+encodeURIComponent(YW.UA())+"&msg="+encodeURIComponent($("#feedbackTextArea").val())});closeModal();showNotif("Thanks for your feedback. We will get back to you shortly.");setTimeout(function(){hideNotif()},3000)}function randomPicGen(g,b){var f=getRandomInt(136,202);var e=getRandomInt(136,202);var a=getRandomInt(136,202);var c=getRandomInt(-2,8);var d=getRandomInt(-5,0);g.css("background-color","rgba("+f+","+e+","+a+",1)");g.find("p").html(b.substr(0,1).toUpperCase());g.find("p").css({top:d+"px",left:c+"px"})}function showUnreadMsg(a,b){if(b>99){b="*"}$(a).find("#unreadMsgCnt").css("display","block").html(b);$(a).css("background-color","rgba(255, 82, 0, 0.0901961)")}function renderSearchedContact(){var d=$("#contactSearchbar");var c=d.val();if(c==""){$(".contact").css("display","block");return}$(".contact").css("display","none");var a=findContactByName(c);for(var e=0;e<a.length;e++){var b=a[e].phone;var f=a[e].cc;$("[id="+b+"]").each(function(g,j){if($(j).prev().html()==f){$(j).parent().css("display","block")}})}}function loadMediaURL(b,c){b=decodeURIComponent(b);console.log(b);if(c==="image"){var a=new Image();a.src=b;a.onload=function(){$("#mediaDisplay #displayContent").html(a);var e=$("#displayContent img").width();var d=$("#displayContent img").height();$("#mediaDisplay").css({height:d+"px",width:e+"px"})}}else{if(c==="video"){$("#mediaDisplay").css({height:460+"px",width:618+"px","max-width":700+"px"});$("#mediaDisplay #displayContent").html('<video src="'+b+'" width="640" height="480"></video>');$("video").mediaelementplayer({defaultVideoWidth:640,defaultVideoHeight:480,videoWidth:-1,videoHeight:-1,audioWidth:400,audioHeight:30,startVolume:1,loop:false,enableAutosize:true,features:["playpause","progress","current","duration","volume","fullscreen"],alwaysShowControls:false,iPadUseNativeControls:false,iPhoneUseNativeControls:false,AndroidUseNativeControls:false,alwaysShowHours:false,showTimecodeFrameCount:false,framesPerSecond:25,enableKeyboard:true,pauseOtherPlayers:true,keyActions:[]})}}showMediaDisplay()}function showMediaDisplay(){showOverlay();$("#mediaDisplay").css({display:"block"})}function closeMediaDisplay(){closeOverlay();$("#mediaDisplay").css({display:"none",width:"200px",height:"40px","max-width":"500px"});$("#mediaDisplay #displayContent").html('<div class="mediaLoading">Loading</div>')}function renderProfPrev(a){var b=$(a).val();$("#profPreviewName").html(b);if(b==""){$("#profPreviewName").html($("#profilename").html());randomPicGen($("#profPreviewPic"),$("#profilename").html());return}if(b.length==1){randomPicGen($("#profPreviewPic"),b)}}function showVerWindow(){$("#varifyWindow").css("display","inline-block");$("#varifyWindow").animate({opacity:"1"},100,function(){$(this).find("#varifyWindowContainerHeader").animate({opacity:"1"},100,function(){$("#progBarBg").animate({opacity:"1"},100,function(){$("#fstStop").find(".innerDisk").animate({opacity:"1"},200);$("#stpDlgBox1").css({opacity:"0",display:"inline-block"});$("#stpDlgBox1").animate({opacity:"1"},300,function(){$("#stpDlgBox1Container").animate({opacity:"1"},300,verMethodSelect("sms"))})})})})}function verMethodSelect(a){if(a=="sms"){$("#verVoiceWrapper").css("opacity","");$("#selectVOICE").css("background-image","");$("#verSMSWrapper").css("opacity","1");$("#selectSMS").css("background-image",'url("./icons/check_20x20.png")');$("#verSelectedIcon").css("background-image",'url("./icons/msg2_min.png")');$("#verStp1LeftBottom").find("p").html("Code will be sent via SMS");YW.VIA=a}else{if(a=="voice"){$("#verSMSWrapper").css("opacity","");$("#selectSMS").css("background-image","");$("#verVoiceWrapper").css("opacity","1");$("#selectVOICE").css("background-image",'url("./icons/check_20x20.png")');$("#verSelectedIcon").css("background-image",'url("./icons/voiceCall_min.png")');$("#verStp1LeftBottom").find("p").html("Code will be sent via Voice Call");YW.VIA=a}}}function enterVerCode(){$("#stpDlgBox1Container").animate({opacity:"0"},300,function(){$("#stpDlgBox1").animate({left:"71px"},400,function(){$("#sndStop").find(".innerDisk").css("opacity","1");$("#stpDlgBox1").css("display","none");$("#stpDlgBox2").css("display","inline-block");$("#stpDlgBox2Container").animate({opacity:"1"},300,function(){$("#verCodeField").focus()})});$("#fstStop").find(".innerDisk").css("background-color","transparent");$("#fstStop").find(".innerDisk").css("background-image",'url("./icons/check.png")')})}function successDialougeBox(){$("#stpDlgBox2Container").animate({opacity:"0"},300,function(){$("#stpDlgBox2").animate({left:"71px"},400,function(){$("#trdStop").find(".innerDisk").css("opacity","1");$("#stpDlgBox2").css("display","none");$("#stpDlgBox3").css("display","inline-block");$("#stpDlgBox3Container").animate({opacity:"1"},300);a(5);function a(b){if(!b){return}$("#verStp3Icon").animate({opacity:".2"},500,function(){$("#verStp3Icon").animate({opacity:".6"},500,function(){b--;a(b)})})}});$("#sndStop").find(".innerDisk").css("background-color","transparent");$("#sndStop").find(".innerDisk").css("background-image",'url("./icons/check.png")')})}function addContact(){var f=$("#addContactAnimation").find("#arrow"),e=$("#contactFirstName").val(),d=$("#countryCode").val(),b=$("#phNumber").val(),a=$("#countryName").val();if(e===""){showPopNotification("Empty Name");return false}if(parseInt(b)!=b){showPopNotification("Wrong Phone Number");return false}b=parseInt(b);if(!isInt(b)||b===0||b===""){showPopNotification("Wrong Phone Number");return false}if(parseInt(d)!=d){showPopNotification("Wrong CC");return false}d=parseInt(d);if(!isInt(d)||d===0||d===""){showPopNotification("Wrong CC");return false}if(a===""){a="Random"}itemNumber=parseInt(d+""+b);if(YW.DATA[itemNumber]){showPopNotification("Duplicate Contact");return false}$("#contactNameAnimatedMsgBox").html(e).animate({opacity:"1"},700,"swing");times=1;$aJX_status=$.ajax({type:"POST",url:"user.php?request=addfriend",data:{contact:b,cc:d,name:e},dataType:"text"}).success(function(i){times=0;if(i===true){return true}else{return false}}).fail(function(i){times=0;return false});sendPage("/addContact");g();function g(){if(times==0){i("#phonebookAnimatedMsgBox","1","0",800);$("#phonebook").css("opacity",".3");$("#addingTextAnimatedMsgBox").css("opacity","0");$("#contactNameAnimatedMsgBox").css("opacity","0");c();return}f.css({left:"0px",opacity:"0"});i("#user",".7",".3",300);i("#phonebook",".3",".7",300);i("#addingTextAnimatedMsgBox","1",".3",300);f.animate({left:"100px",opacity:"1"},300,"linear",function(){f.animate({left:"200px",opacity:"0"},300,"linear",function(){g()})});function i(n,k,j,l){$(n).animate({opacity:k},l,"swing",function(){$(n).animate({opacity:j},l,"swing")})}}function c(){var j=$("#addContactForm").html();var i='<div id="userInfoHeader">CONTACT DETAILS</div><div id="userInfoDiv"><div class="userInfoDivMemberwrapper"><div class="userInfoDivMemberIcons" id="userInfoDivMemberIconsUser"></div><div class="userInfoDivMemberText" id="userInfoDivMemberTextUsername"></div></div><div class="userInfoDivMemberwrapper"><div class="userInfoDivMemberIcons" id="userInfoDivMemberIconsPhone"></div><div class="userInfoDivMemberText" id="userInfoDivMemberTextNumber"></div></div><div class="userInfoDivMemberwrapper"><div class="userInfoDivMemberIcons" id="userInfoDivMemberIconsCountry"></div><div class="userInfoDivMemberText" id="userInfoDivMemberTextCountry"></div></div></div><div id="phonebookContainter"></div><div id="successfullTag">Added To Phonebook Successfully</div>';$("#addContactForm").fadeOut(500,function(){$("#addContactForm").html(i);$("#addContactForm").fadeIn(400,function(){$("#userInfoDivMemberTextUsername").html(e);$("#userInfoDivMemberTextNumber").html("("+d+") "+b);$("#userInfoDivMemberTextCountry").html(a);addContactElem(e,b,d);itemNumber=parseInt(d+""+b);YW.DATA[itemNumber]={phone:b,cc:d,name:e,messages:{},messageTree:[]};sendPage("/home");k(3);function k(l){if(!l){return}$("#phonebookContainter").animate({opacity:".3"},300,"swing",function(){$("#phonebookContainter").animate({opacity:".6"},300,"swing",function(){l--;k(l)})})}})})}}function addSearchElem(b,d,a){var c='<div class="suggestedElem" onclick="fillEditContact(\''+b+"',"+d+","+a+')"><p>'+b+" (+"+d+"-"+a+")</p></div>";$("#firstNameList").append(c).css("display","block")}function fillEditContact(b,c,a){$("#contactFirstNameEdit").val(b);$("#phNumberEdit").val(a);$("#countryCodeEdit").val(c);$("#countryNameEdit").val(CCtoCountry(c));$("#firstNameList").html("")}function emptyEditContact(){$("#contactFirstNameEdit").val("").focus();hideTip("#contactFirstNameEdit");$("#phNumberEdit").val("");$("#countryCodeEdit").val("");$("#countryNameEdit").val("")}function suggestNames(a){$("#firstNameList").html("");if(a==""){$("#firstNameList").css("display","none");return false}if($("#phNumberEdit").val()!=""){$("#firstNameList").css("display","none");return false}var b=findContactByName(a);b.forEach(function(c){addSearchElem(c.name,c.cc,c.phone)})}function checkResponse(b,c,a){b=(typeof b==="string")?b.trim():b;if(b==="noauth"){closeModal();sendPage("/"+c+"/noauth");showPopNotification("You are not logged in.",function(){window.location="logout.php"});return false}if(b==="badparam"){closeModal();sendPage("/"+c+"/badparam");showPopNotification("Something went wrong with the request. Please try again.");return false}if(b==="sqlfail"){closeModal();sendPage("/"+c+"/sqlfail");showPopNotification("Database was unreachable. Please try again after sometime.");return false}if(b==="success"){if(a){a()}closeModal();sendPage("/"+c+"/success");showPopNotification("Successful.");return true}else{closeModal();sendPage("/"+c+"/error");showPopNotification("Some unknown error happened. Please report a feedback with details.");return false}}function handle_failure(a){closeModal();sendPage("/"+a+"/networkError");showPopNotification("Network Error. Please refresh the page and try again.");return false}function updateContact(){var d=$("#contactFirstNameEdit").val(),c=$("#countryCodeEdit").val(),b=$("#phNumberEdit").val(),a=$("#countryName").val();if(d===""){showPopNotification("Empty Name.");return false}sendPage("/updateContact");showNotif("Processing your update request.");$aJX_status=$.ajax({type:"POST",url:"user.php?request=updateFriend",data:{contact:b,cc:c,name:d},dataType:"text"}).success(function(e){return checkResponse(e,"updateContact",function(){var i=$("#contactFirstNameEdit").val(),g=$("#countryCodeEdit").val(),f=$("#phNumberEdit").val();updateContactname(i,g,f);YW.DATA[g+f].name=i;emptyEditContact()})}).fail(function(){return handle_failure("updateContact")})}function deleteContact(){var b=$("#countryCodeEdit").val();var a=$("#phNumberEdit").val();sendPage("/deleteContact");showNotif("Processing delete request.");$aJX_status=$.ajax({type:"POST",url:"user.php?request=deleteFriend",data:{contact:a,cc:b},dataType:"text"}).success(function(c){return checkResponse(c,"deleteContact",function(){var e=$("#countryCodeEdit").val();var d=$("#phNumberEdit").val();emptyEditContact();delete YW.DATA[e+d];$("[id="+d+"]").each(function(f,g){if($(g).prev().html()==e){$(g).parent().remove();showPopNotification("Delete successfully.");return true}})})}).fail(function(c){return handle_failure("deleteContact")})}function editProfileClick(){var a=$("#editProfName").val();if(a===""){showPopNotification("Name field is empty.");return false}sendPage("/editProfile");showNotif("Processing your Name Update Request.");$aJX_status=$.ajax({type:"POST",url:"user.php?request=updateName",data:{name:a},dataType:"text"}).success(function(b){return checkResponse(b,"editProfile",function(){$("#profilename").html(a);randomPicGen($("#profilepic"),a);YW.NAME=a})}).fail(function(b){return handle_failure("editProfile")})}function changePassword(){var c=$("#editProfPass").val();var a=$("#editProfPassRe").val();if(c===""){showPopNotification("Password field is empty.");return false}if(c!==a){showPopNotification("Both the passwords do not match.");$("#editProfPassRe").val("");$("#editProfPass").val("");return false}var b=/(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}/;if(!b.test(c)){showPopNotification("Passwords must contain at least one number, one lowercase and one uppercase letter.  Please try again.");$("#editProfPassRe").val("");$("#editProfPass").val("");return false}var d=hex_sha512(c);sendPage("/changePassword");$aJX_status=$.ajax({type:"POST",url:"user.php?request=updatePass",data:{p:d},dataType:"text"}).success(function(e){return checkResponse(e,"changePassword")}).fail(function(e){return handle_failure(e)})};